<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/AI-book/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/AI-book/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li:not(:nth-child(15)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(15) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(15) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(15) > ul.nav-list { display: block; } </style> <script src="/AI-book/assets/js/vendor/lunr.min.js"></script> <script src="/AI-book/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>NanoGPT | L’IA en pratique avec python.</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="NanoGPT" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Ce site web présente les exemples de programmes décrit dans le livre l’IA en pratique avec python. Ici sont présentés les différentes solutions des problèmes utilisants différentes techniques de l’IA implementés en python." /> <meta property="og:description" content="Ce site web présente les exemples de programmes décrit dans le livre l’IA en pratique avec python. Ici sont présentés les différentes solutions des problèmes utilisants différentes techniques de l’IA implementés en python." /> <link rel="canonical" href="https://iridia-ulb.github.io/AI-book/docs/nanogpt.html" /> <meta property="og:url" content="https://iridia-ulb.github.io/AI-book/docs/nanogpt.html" /> <meta property="og:site_name" content="L’IA en pratique avec python." /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="NanoGPT" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Ce site web présente les exemples de programmes décrit dans le livre l’IA en pratique avec python. Ici sont présentés les différentes solutions des problèmes utilisants différentes techniques de l’IA implementés en python.","headline":"NanoGPT","url":"https://iridia-ulb.github.io/AI-book/docs/nanogpt.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/AI-book/" class="site-title lh-tight"> L'IA en pratique avec python. </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/AI-book/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/AI-book/instructions" class="nav-list-link">Instructions générales</a></li><li class="nav-list-item"><a href="/AI-book/faq" class="nav-list-link">Foire aux questions (FAQ)</a></li><li class="nav-list-item"><a href="/AI-book/docs/8puzzle.html" class="nav-list-link">Le Taquin</a></li><li class="nav-list-item"><a href="/AI-book/docs/shortest.html" class="nav-list-link">Le plus court chemin</a></li><li class="nav-list-item"><a href="/AI-book/docs/sudoku.html" class="nav-list-link">Sudoku</a></li><li class="nav-list-item"><a href="/AI-book/docs/snake.html" class="nav-list-link">Snake</a></li><li class="nav-list-item"><a href="/AI-book/docs/connect4.html" class="nav-list-link">Puissance 4</a></li><li class="nav-list-item"><a href="/AI-book/docs/tetris.html" class="nav-list-link">Tetris</a></li><li class="nav-list-item"><a href="/AI-book/docs/SpamDetec.html" class="nav-list-link">Spam Detector</a></li><li class="nav-list-item"><a href="/AI-book/docs/decisiontree.html" class="nav-list-link">Decision trees</a></li><li class="nav-list-item"><a href="/AI-book/docs/nlp.html" class="nav-list-link">Natural langage processing</a></li><li class="nav-list-item"><a href="/AI-book/docs/catdog.html" class="nav-list-link">Chien ou chat?</a></li><li class="nav-list-item"><a href="/AI-book/docs/SpamDetec2.html" class="nav-list-link">Spam Detector 2</a></li><li class="nav-list-item"><a href="/AI-book/docs/nanogpt.html" class="nav-list-link">NanoGPT</a></li><li class="nav-list-item"><a href="/AI-book/about" class="nav-list-link">À propos</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search L'IA en pratique avec python." aria-label="Search L'IA en pratique avec python." autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <div id="main-content" class="main-content"> <main> <h1 id="nanogpt"> <a href="#nanogpt" class="anchor-heading" aria-labelledby="nanogpt"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> NanoGPT </h1> <p>Vous trouverez ci-dessous les instructions et détails sur l’application de NanoGPT. le but de cette application est de génerer automatiquement du texte “à la manière de”. Dans notre exemple le programme genère des textes ressemblants à des oeuvres de Shakespeare.</p> <h2 id="installation"> <a href="#installation" class="anchor-heading" aria-labelledby="installation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Installation </h2> <p>Pour installer l’application, commencez par copier le dépot du livre ([AI-book sur github][ia-gh]), soit en recupérant l’archive zip depuis github, soit à l’aide de l’outil git:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/iridia-ulb/AI-book
</code></pre></div></div> <p>Puis, accedez au dossier:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>NanoGPT
</code></pre></div></div> <p>Après avoir installé python et poetry, rendez vous dans ce dossier et installez les dépendances du projet:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>poetry <span class="nb">install</span>
</code></pre></div></div> <h2 id="utilisation"> <a href="#utilisation" class="anchor-heading" aria-labelledby="utilisation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Utilisation </h2> <p>Pour lancer un entrainement avec le corpus de Shakespeare il suffit de lancer, par exemple, avec une <code class="language-plaintext highlighter-rouge">block_size</code> de 512 et 10 000 itérations:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>poetry run python main.py <span class="nt">--train</span> <span class="nt">--save_model</span> my_new_model.pth <span class="nt">--block_size</span> 512 <span class="nt">--eval_iters</span> 10000
</code></pre></div></div> <p>Il est aussi possible de changer le corpus d’entrainement avec le paramètre <code class="language-plaintext highlighter-rouge">--input</code> (par défaut celui-ci le programme prend le fichier <code class="language-plaintext highlighter-rouge">input.txt</code> contenant le corpus de Shakespeare).</p> <p>Par la suite, une fois entrainé, pour tester votre modèle:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>poetry run python main.py <span class="nt">--infer</span> <span class="nt">--load_model</span> my_new_model.pth <span class="nt">--block_size</span> 512
</code></pre></div></div> <p>Veillez à bien sélectionner les mêmes paramètres lors de l’entrainement et de l’inférence (ici par exemple la <code class="language-plaintext highlighter-rouge">block_size</code>)</p> <p>Toute une liste de paramètres supplémentaires sont configurables :</p> <ul> <li> <p><code class="language-plaintext highlighter-rouge">--train</code> : Mode entraînement</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">--infer</code> : Mode inférence</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">--input</code> : fichier d’entrée de corpus d’entrainement</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">--save_model SAVE_MODEL</code> : Sauvegarde le modèle dans le fichier spécifié</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">--load_model LOAD_MODEL</code> : Charge le modèle depuis le fichier spécifié</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">--batch_size BATCH_SIZE</code> : Nombre d’I/O que le modèle doit apprendre par batch</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">--block_size BLOCK_SIZE</code> : Longueur des séquences que le transformer doit apprendre</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">--max_iters MAX_ITERS</code> : Nombre d’itérations d’apprentissage</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">--eval_interval EVAL_INTERVAL</code> : Intervalle d’évaluation pendant l’entraînement</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">--learning_rate LEARNING_RATE</code> : Taux d’apprentissage</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">--eval_iters EVAL_ITERS</code> : Nombre d’itérations d’évaluation</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">--n_embd N_EMBD</code> : Dimension de l’espace dans lequel on projette les caractères</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">--n_head N_HEAD</code> : Nombre de têtes d’attention</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">--n_layer N_LAYER</code> : Nombre de couches</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">--dropout DROPOUT</code> : Probabilité de dropout</p> </li> </ul> <p>En résumé:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>usage: main.py [-h] [--train] [--infer] [--save_model SAVE_MODEL] [--load_model LOAD_MODEL] [--input INPUT] [--batch_size BATCH_SIZE]
               [--block_size BLOCK_SIZE] [--max_iters MAX_ITERS] [--eval_interval EVAL_INTERVAL] [--learning_rate LEARNING_RATE]
               [--eval_iters EVAL_ITERS] [--n_embd N_EMBD] [--n_head N_HEAD] [--n_layer N_LAYER] [--dropout DROPOUT]

Train and/or infer with a language model

options:
  -h, --help            show this help message and exit
  --train               Mode entraînement
  --infer               Mode inférence
  --save_model SAVE_MODEL
                        Sauvegarde le modèle dans le fichier spécifié
  --load_model LOAD_MODEL
                        Charge le modèle depuis le fichier spécifié
  --input INPUT         Utilise les données d'entrainement depuis le fichier spécifié
  --batch_size BATCH_SIZE
                        Nombre d'I/O que le modèle doit apprendre par batch
  --block_size BLOCK_SIZE
                        Longueur des séquences que le transformer doit apprendre
  --max_iters MAX_ITERS
                        Nombre d'itérations d'apprentissage
  --eval_interval EVAL_INTERVAL
                        Intervalle d'évaluation pendant l'entraînement
  --learning_rate LEARNING_RATE
                        Taux d'apprentissage
  --eval_iters EVAL_ITERS
                        Nombre d'itérations d'évaluation
  --n_embd N_EMBD       Dimension de l'espace dans lequel on projette les caractères
  --n_head N_HEAD       Nombre de têtes d'attention
  --n_layer N_LAYER     Nombre de couches
  --dropout DROPOUT     Probabilité de dropout
</code></pre></div></div> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
